---
title: "R Markdown Introduction"
output: pdf_document
date: "2024-09-19"
author: y kim
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown (src: RStudio)

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

## Math 2265 Section 4.1

### Load Packages

```{r}
library(openintro)
library(ggplot2)
set.seed(2265)
```

### Short Recap

In the following we plot the box plot of the variable `interest_rate` in the dataset `loan50`. 

```{r}
ggplot(data=loan50, mapping=aes(x=interest_rate)) +
  geom_boxplot()
```

### Head vs. Tail

We make a simulation of a fair coin toss. 

```{r}
coin <- c("H", "T") # define a vector consisting of "H" and "T"
sample(coin, 1)
```

Execute this cell by clicking on the green |> button. 

Let's see what happens when we toss the coin 10 times.

```{r}
coin <- c("H", "T") # define a vector consisting of "H" and "T"
sample(coin, 10)
```
This will result in error since we want to grab 10 when there are only two. We can set the `replace` parameter `TRUE`. 

```{r}
coin <- c("H", "T") # define a vector consisting of "H" and "T"
sample(coin, 10, replace = TRUE)
```

Run this a few times. 

**Question 1.** Did you get the even number of heads and tails? 

**Ans:**

**Question 2.** Complete the following code to run a simulation for tossing the coin 500 times. 

```{r}
coin <- c("H", "T") # define a vector consisting of "H" and "T"
result <- sample(coin, <>, replace = TRUE)
table(result) # `table` tallies the result  
```

Run this code a few times. 

> The Law of Large Numbers

**Question 3.**

The following code runs 1000 simulations of tossing coins 500 times and save the number of heads in each simulation to the variable `num_heads`. 
```{r}
coin <- c("H", "T") # define a vector consisting of "H" and "T"
num_heads <- replicate(1000, as.numeric(table(sample(coin, 500, replace = TRUE))[1]))
data_coin <- data.frame(
  num_heads
) # it will be used in the next question
num_heads[1:5] # prints the first 5 results
```

```{r}
print(str(data_coin))
ggplot(data=data_coin, aes(x=num_heads)) +
  geom_histogram()
```
Now, increase the number of simulations high enough to see a more bell-shaped distribution.

```{r}
coin <- c("H", "T") # define a vector consisting of "H" and "T"
num_heads <- replicate(10000, as.numeric(table(sample(coin, 500, replace = TRUE))[1]))
data_coin <- data.frame(
  num_heads
) # it will be used in the next question
ggplot(data=data_coin, aes(x=num_heads)) +
  geom_histogram(bins=22)
```